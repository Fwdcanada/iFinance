<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Loan Calculator</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100 p-6">
  <main class="max-w-3xl mx-auto bg-white p-6 rounded-xl shadow">
    <h1 class="text-2xl font-bold mb-4 text-center">Loan Calculator</h1>

    <label for="amount" class="block font-semibold">Total Purchase Amount ($)</label>
    <input id="amount" type="number" class="border p-2 w-full rounded mb-4">

    <label for="downPayment" class="block font-semibold">Down Payment ($)</label>
    <input id="downPayment" type="number" class="border p-2 w-full rounded mb-4">

    <label for="province" class="block font-semibold">Province</label>
    <select id="province" class="border p-2 w-full rounded mb-4">
      <option value="QC">Quebec</option>
      <option value="ON">Ontario</option>
      <option value="BC">British Columbia</option>
      <option value="AB">Alberta</option>
      <option value="MB">Manitoba</option>
      <option value="SK">Saskatchewan</option>
      <option value="NS">Nova Scotia</option>
      <option value="NB">New Brunswick</option>
      <option value="NL">Newfoundland and Labrador</option>
      <option value="PE">Prince Edward Island</option>
      <option value="NT">Northwest Territories</option>
      <option value="NU">Nunavut</option>
      <option value="YT">Yukon</option>
    </select>

    <label for="creditScore" class="block font-semibold">Credit Score</label>
    <select id="creditScore" class="border p-2 w-full rounded mb-4">
      <option value="Excellent">Excellent</option>
      <option value="Very Good">Very Good</option>
      <option value="Good">Good</option>
      <option value="Fair">Fair</option>
      <option value="Poor">Poor</option>
    </select>

    <button onclick="calculateLoan()" class="bg-blue-600 text-white w-full py-2 rounded mb-4">Calculate</button>

    <div class="bg-gray-100 p-4 rounded text-center mb-4">
      <p><strong>Total Taxes:</strong> $<span id="totalTax">0.00</span></p>
      <p><strong>Total Amount:</strong> $<span id="totalAmount">0.00</span></p>
    </div>

    <h3 class="text-lg font-semibold mb-2">Monthly Payment Comparison</h3>
    <p class="text-sm text-red-600 mb-2" id="termNote"></p>
    <table class="w-full text-sm bg-white rounded overflow-hidden">
      <thead class="bg-gray-200">
        <tr><th class="p-2">Term (months)</th><th class="p-2">Monthly Payment</th></tr>
      </thead>
      <tbody id="termComparisonTable"></tbody>
    </table>
  </main>

  <script>
    function calculateLoan() {
      const amount = parseFloat(document.getElementById("amount").value) || 0;
      const down = parseFloat(document.getElementById("downPayment").value) || 0;
      const province = document.getElementById("province").value;
      const creditScore = document.getElementById("creditScore").value;
      const total = amount - down;

      const taxRates = {
        QC: 0.14975, ON: 0.13, BC: 0.12, AB: 0.05, MB: 0.12, SK: 0.11,
        NS: 0.15, NB: 0.15, NL: 0.15, PE: 0.15, NT: 0.05, NU: 0.05, YT: 0.05
      };

      const tax = total * (taxRates[province] || 0.13);
      const totalWithTax = total + tax;

      const rateAdjustments = {
        Excellent: 0.0999,
        "Very Good": 0.1299,
        Good: 0.1499,
        Fair: 0.1699,
        Poor: 0.1999
      };

      const adjustment = rateAdjustments[creditScore] || 0.1499;
      const monthlyInterestRate = adjustment / 12;

      const terms = [12, 24, 36, 48, 60, 72, 84];
      const table = document.getElementById("termComparisonTable");
      const note = document.getElementById("termNote");
      if (table) table.innerHTML = "";
      if (note) note.textContent = "";

      terms.forEach(term => {
        if (total < 3000 && term > 60) return;
        if (total >= 3000 && total < 10000 && term > 72) return;

        if (total < 3000 && term > 60 && note) note.textContent = "Terms over 60 months available only on loans $3,000 and up.";
        if (total >= 3000 && total < 10000 && term > 72 && note) note.textContent = "Terms up to 84 months available only on loans $10,000 and up.";

        const monthly = (totalWithTax * monthlyInterestRate * Math.pow(1 + monthlyInterestRate, term)) /
                        (Math.pow(1 + monthlyInterestRate, term) - 1);

        const row = `<tr><td class='p-2'>${term}</td><td class='p-2'>$${monthly.toFixed(2)}</td></tr>`;
        if (table) table.innerHTML += row;
      });

      if (document.getElementById("totalTax")) {
        document.getElementById("totalTax").textContent = tax.toFixed(2);
      }
      if (document.getElementById("totalAmount")) {
        document.getElementById("totalAmount").textContent = totalWithTax.toFixed(2);
      }
    }
  </script>
</body>
</html>




